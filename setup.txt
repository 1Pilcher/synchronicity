@echo off
title Market Setup
echo ============================================
echo    Setting up your Market environment...
echo ============================================

REM Step 1: Check if Python is installed
where python >nul 2>nul
if %errorlevel% neq 0 (
    echo Python not found. Installing Miniconda...
    powershell -Command "Invoke-WebRequest https://repo.anaconda.com/miniconda/Miniconda3-latest-Windows-x86_64.exe -OutFile miniconda_installer.exe"
    start /wait "" miniconda_installer.exe /InstallationType=JustMe /RegisterPython=1 /AddToPath=1 /S /D=%cd%\Miniconda3
    setx PATH "%cd%\Miniconda3\Scripts;%cd%\Miniconda3"
    del miniconda_installer.exe
)

REM Step 2: Install Python packages
echo Installing required Python packages...
pip install --upgrade pip
pip install yfinance pandas tqdm openpyxl

REM Step 3: Done
echo.
echo âœ… Setup complete!
pause
